apiVersion: dope.metacontroller.io/v1
kind: Recipe
metadata:
  name: assert-github-search
  namespace: d-testing
  labels:
    d-testing.dope.metacontroller.io/inference: "true"
spec:
  tasks:
  # Start by applying this HTTP custom resource
  #
  # NOTE:
  #   Once this resource is applied against the Kubernetes
  # cluster, it starts invoking the http request specified
  # in its spec. Resulting output is set against its status.
  - name: apply-github-search
    apply: 
      state: 
        apiVersion: dope.metacontroller.io/v1
        kind: HTTP
        metadata:
          name: github-search
          namespace: d-testing
        spec:
          url: https://github.com/search
          method: GET
  # Then assert this HTTP resource to have completed
  # successfully
  - name: assert-github-search
    assert: 
      state: 
        apiVersion: dope.metacontroller.io/v1
        kind: HTTP
        metadata:
          name: github-search
          namespace: d-testing
        status:
          # If HTTP resource completes successfully then
          # phase should be set to Completed
          phase: Online
---